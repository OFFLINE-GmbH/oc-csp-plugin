# oc-csp-plugin

This plugin allows you to manage the [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy)
of your website via October's backend.

You should know what a CSP is and how it works to use this plugin. You can
[read more about this topic on MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy).


## Features

The `OFFLINE.CSP` plugin provides the following features:

* The Content-Security-Policy can be configured in the backend 
* Policy violations are automatically logged and can be viewed in the backend
* A per-request [`nonce`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src#Unsafe_inline_script) is generated and can be used on-demand
* The `nonce` can optionally be injected in all `<script>` and `<style>` tags

## Getting started

Install the plugin and visit the CSP page in the backend settings. Configure
the CSP according to your needs. Then enable the CSP header.

By default, a strict policy is set. We suggest you make your page work with
this preset for optimal security. 

We suggest that you start in `Report only` mode. This will generate console
messages and a log entry for each validation of the CSP.

You can visit the log via the backend. You will find a log entry
for every violation generated by your site. Tune your CSP until no more
violations are logged.

Now you are ready to disable the `Report only` mode and actually block violating requests.

## Test your CSP

You can test the strength of your CSP using [Google's CSP validator](https://csp-evaluator.withgoogle.com/)
or the [Mozilla Obervatory](https://observatory.mozilla.org/).

## When things break

A misconfigured CSP can break your site. Make sure to work in `Report only` mode
until you have fine-tuned your site to your CSP.

If for any reason you are unable to access your site after you enabled the CSP,
you can run the following console command to disable the plugin completely:

```
php artisan csp:disable
``` 



 
